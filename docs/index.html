<!DOCTYPE HTML>
<html>

<head>
    <meta charset="utf-8" />
    <title>Monocart Coverage Reports</title>
    <link rel="icon" href="data:,">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <link rel="stylesheet" href="assets/github-markdown.css" />
</head>

<body>
<div class="markdown-body">
<h1>Monocart Coverage Reports</h1>
<p><a target="_blank" href="https://www.npmjs.com/package/monocart-coverage-reports"><img src="https://img.shields.io/npm/v/monocart-coverage-reports" alt=""></a>
<a target="_blank" href="https://www.npmjs.com/package/monocart-coverage-reports"><img src="https://badgen.net/npm/dw/monocart-coverage-reports" alt=""></a>
<img src="https://img.shields.io/github/license/cenfun/monocart-coverage-reports" alt=""></p>
<blockquote>
<p>Code coverage tool to generate <a target="_blank" href="https://v8.dev/blog/javascript-code-coverage">V8</a> or <a target="_blank" href="https://istanbul.js.org/">Istanbul</a> coverage reports.</p>
</blockquote>
<h2>Preview Reports</h2>
<ul>
<li><a target="_blank" href="./v8">V8</a></li>
<li><a target="_blank" href="./v8-minify">V8 Minify</a></li>
<li><a target="_blank" href="./v8-and-istanbul/istanbul">V8 to Istanbul</a></li>
<li><a target="_blank" href="./istanbul/">Istanbul</a></li>
<li><a target="_blank" href="https://cenfun.github.io/monocart-reporter/">Integration with Monocart Reporter</a> - Playwright test report</li>
</ul>
<h2>Usage</h2>
<pre><code class="language-js">const CoverageReport = require(&#39;monocart-coverage-reports&#39;);
const options = {
    outputDir: &#39;./coverage-reports&#39;,
    reports: &quot;v8&quot;
}
const coverageReport = new CoverageReport(options);
await coverageReport.add(coverageData1);
await coverageReport.add(coverageData2);
const coverageResults = await coverageReport.generate();
console.log(coverageResults.summary);
</code></pre>
<ul>
<li><a target="_blank" href="https://github.com/cenfun/monocart-coverage-reports/blob/main/tests/test-v8.js">example v8</a></li>
<li><a target="_blank" href="https://github.com/cenfun/monocart-coverage-reports/blob/main/tests/test-istanbul.js">example istanbul</a></li>
</ul>
<h2>Default Options</h2>
<ul>
<li><a target="_blank" href="https://github.com/cenfun/monocart-coverage-reports/blob/main/lib/default/options.js">lib/default/options.js</a></li>
</ul>
<h2>Multiple Reports</h2>
<ul>
<li>v8 report<ul>
<li>v8</li>
</ul>
</li>
<li><a target="_blank" href="https://github.com/istanbuljs/istanbuljs/tree/master/packages/istanbul-reports/lib">istanbul reports</a><ul>
<li>clover</li>
<li>cobertura</li>
<li>html</li>
<li>html-spa</li>
<li>json</li>
<li>json-summary</li>
<li>lcov</li>
<li>lcovonly</li>
<li>none</li>
<li>teamcity</li>
<li>text</li>
<li>text-lcov</li>
<li>text-summary</li>
</ul>
</li>
</ul>
<pre><code class="language-js">const CoverageReport = require(&#39;monocart-coverage-reports&#39;);
const options = {
    outputDir: &#39;./coverage-reports&#39;,
    reports: [
        [&#39;v8&#39;],
        [&#39;html&#39;, {
            subdir: &#39;istanbul&#39;
        }],
        [&#39;json&#39;, {
            file: &#39;my-json-file.json&#39;
        }],
        &#39;lcovonly&#39;
    ]
}
const coverageReport = new CoverageReport(options);
</code></pre>
<h1>Multiprocessing Support</h1>
<p>The data will be added to <code>[outputDir]/.cache</code>, and the cache will be removed after reports generated.</p>
<ul>
<li>sub process 1</li>
</ul>
<pre><code class="language-js">const CoverageReport = require(&#39;monocart-coverage-reports&#39;);
const options = require(&#39;path-to/same-options.js&#39;);
const coverageReport = new CoverageReport(options);
await coverageReport.add(coverageData1);
</code></pre>
<ul>
<li>sub process 2</li>
</ul>
<pre><code class="language-js">const CoverageReport = require(&#39;monocart-coverage-reports&#39;);
const options = require(&#39;path-to/same-options.js&#39;);
const coverageReport = new CoverageReport(options);
await coverageReport.add(coverageData2);
</code></pre>
<ul>
<li>main process</li>
</ul>
<pre><code class="language-js">// after all sub processes finished
const CoverageReport = require(&#39;monocart-coverage-reports&#39;);
const options = require(&#39;path-to/same-options.js&#39;);
const coverageReport = new CoverageReport(options);
const coverageResults = await coverageReport.generate();
console.log(coverageResults.summary);
</code></pre>
<h2>Compare Reports</h2>
<table>
<thead>
<tr>
<th align="left"></th>
<th align="left">Istanbul</th>
<th align="left">V8</th>
<th align="left">V8 to Istanbul</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Input</td>
<td align="left">Istanbul (Object)</td>
<td align="left">V8 (Array)</td>
<td align="left">V8 (Array)</td>
</tr>
<tr>
<td align="left">Output</td>
<td align="left"><a target="_blank" href="./istanbul">Istanbul HTML report</a></td>
<td align="left"><a target="_blank" href="./v8">V8 HTML report</a></td>
<td align="left"><a target="_blank" href="./v8-and-istanbul/istanbul">Istanbul HTML report</a></td>
</tr>
<tr>
<td align="left">Indicators</td>
<td align="left">Covered Lines, Branches, Statements and Functions, Execution Counts</td>
<td align="left">Covered Bytes, Lines❔, Execution Counts</td>
<td align="left">Covered Lines, Branches❔, Statements and Functions, Execution Counts</td>
</tr>
<tr>
<td align="left">CSS coverage</td>
<td align="left">❌</td>
<td align="left">✅</td>
<td align="left">✅</td>
</tr>
<tr>
<td align="left">Minified code</td>
<td align="left">N/A</td>
<td align="left">✅</td>
<td align="left">❌</td>
</tr>
<tr>
<td align="left">Code formatting</td>
<td align="left">N/A</td>
<td align="left">✅</td>
<td align="left">❌</td>
</tr>
</tbody></table>
<p>❔ - Partial or conditional support</p>
<h2>Compare Workflows</h2>
<ul>
<li><p>Istanbul Workflows</p>
<ul>
<li>1, Only for source code: instrumenting code with <a target="_blank" href="https://github.com/istanbuljs/babel-plugin-istanbul">babel-plugin-istanbul</a>，see <a target="_blank" href="https://github.com/cenfun/monocart-coverage-reports/blob/main/mock/webpack.config-istanbul.js">webpack.config-istanbul.js</a>, or using <a target="_blank" href="https://github.com/istanbuljs/nyc">nyc</a>.</li>
<li>2, Collecting coverage data from browser <code>window.__coverage__</code>, see <a target="_blank" href="https://github.com/cenfun/monocart-coverage-reports/blob/main/tests/test-istanbul.js">example</a>.</li>
<li>3, Generating coverage report.</li>
</ul>
</li>
<li><p>V8 Workflows</p>
<ul>
<li>1, For any runtime code: nothing to do. For source code: building code with <code>development</code> <a target="_blank" href="https://webpack.js.org/configuration/mode/">mode</a> and <a target="_blank" href="https://webpack.js.org/configuration/devtool/">sourcemap</a> support, see <a target="_blank" href="https://github.com/cenfun/monocart-coverage-reports/blob/main/mock/webpack.config-v8.js">webpack.config-v8.js</a>.</li>
<li>2, Collecting coverage data with <a href="#chromium-coverage-api">Chromium Coverage API</a>, see <a target="_blank" href="https://github.com/cenfun/monocart-coverage-reports/blob/main/tests/test-v8.js">example</a>.</li>
<li>3, Generating coverage report.</li>
</ul>
</li>
</ul>
<h2>Chromium Coverage API</h2>
<ul>
<li><a target="_blank" href="https://v8.dev/blog/javascript-code-coverage">V8 coverage report</a> - Native support for JavaScript code coverage to V8. (Chromium only)</li>
<li><a target="_blank" href="https://pptr.dev/api/puppeteer.coverage">Puppeteer Coverage Class</a></li>
<li><a target="_blank" href="https://playwright.dev/docs/api/class-coverage">Playwright Coverage Class</a></li>
<li><a target="_blank" href="https://chromedevtools.github.io/devtools-protocol/tot/Profiler/#method-startPreciseCoverage">DevTools Protocol for Coverage</a></li>
</ul>
<h2>Istanbul Coverage</h2>
<ul>
<li><a target="_blank" href="https://istanbul.js.org/">Istanbul coverage report</a> - Instrumenting source codes and generating coverage reports</li>
<li><a target="_blank" href="https://github.com/istanbuljs/babel-plugin-istanbul">babel-plugin-istanbul</a></li>
<li><a target="_blank" href="https://github.com/istanbuljs/istanbuljs/tree/master/packages/istanbul-reports/lib">istanbul-reports</a></li>
<li><a target="_blank" href="https://docs.cypress.io/guides/tooling/code-coverage">Code Coverage Introduction</a></li>
</ul>
<h2>Thanks</h2>
<ul>
<li>Special thanks to <a target="_blank" href="https://github.com/edumserrano">@edumserrano</a></li>
</ul>

</div>
</body>

</html>